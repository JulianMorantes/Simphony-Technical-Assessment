steps:
  - checkout: self

  - task: Docker@2
    displayName: 'Login a Azure Container Registry'
    inputs:
      command: login
      containerRegistry: $(azureContainerRegistryServiceConnection) # Service connection a ACR

  - task: Docker@2
    displayName: 'Construir imagen Docker'
    inputs:
      command: build
      repository: $(IMAGE_NAME)
      Dockerfile: '**/Dockerfile'
      tags: |
        $(IMAGE_TAG)

  - task: Docker@2
    displayName: 'Push imagen Docker'
    inputs:
      command: push
      repository: $(IMAGE_NAME)
      tags: |
        $(IMAGE_TAG)
